/*!  2017-01-05 */

ChargeIO.init({
    public_key: cio4wc_info.publishableKey
}), jQuery(function(a) {
    function b() {
        g = a("#cio4wc-cc-form"), h = g.find("#cio4wc-card-number"), i = g.find("#cio4wc-card-expiry"), 
        j = g.find("#cio4wc-card-cvc"), cio4wc_info.hasCard && cio4wc_info.savedCardsEnabled && g.hide(), 
        k.on("change", 'input[name="cio4wc_card"]', function() {
            "new" === a('input[name="cio4wc_card"]:checked').val() ? g.slideDown(200) : g.slideUp(200);
        }), l.number && h.val(l.number.val).attr("class", l.number.classes), l.expiry && i.val(l.expiry.val), 
        l.cvv && j.val(l.cvv.val);
    }
    function c(b) {
        if (a("#payment_method_cio4wc").is(":checked") && (!a('input[name="cio4wc_card"]').length || "new" === a('input[name="cio4wc_card"]:checked').val()) && !a("input.chargeio_token").length) {
            var c = a("#cio4wc-card-expiry").val().split("/"), f = {
                month: c[0].replace(" ", ""),
                year: c[1].replace(" ", "")
            }, g = a("#billing_first_name").val() || a("#billing_last_name").val() ? a("#billing_first_name").val() + " " + a("#billing_last_name").val() : cio4wc_info.billing_name, h = {
                number: a("#cio4wc-card-number").val() || "",
                cvv: a("#cio4wc-card-cvc").val() || "",
                exp_month: f.month || "",
                exp_year: f.year || "",
                name: a(".cio4wc-billing-name").val() || g || "",
                address1: a("#billing_address_1").val() || cio4wc_info.billing_address_1 || "",
                address2: a("#billing_address_2").val() || cio4wc_info.billing_address_2 || "",
                phone: a("#billing_phone").val() || cio4wc_info.billing_phone || "",
                city: a("#billing_city").val() || cio4wc_info.billing_city || "",
                state: a("#billing_state").val() || cio4wc_info.billing_state || "",
                postal_code: a(".cio4wc-billing-zip").val() || a("#billing_postcode").val() || cio4wc_info.billing_postcode || "",
                country: a("#billing_country").val() || cio4wc_info.billing_country || ""
            };
            if (k.block({
                message: null,
                overlayCSS: {
                    background: "#fff url(" + woocommerce_params.ajax_loader_url + ") no-repeat center",
                    opacity: .6
                }
            }), e(h)) return ChargeIO.create_token(h, d), !1;
        }
        return !0;
    }
    function d(b) {
        b.error ? (a(".payment-errors, .chargeio_token, .form_errors").remove(), g.before('<span class="payment-errors required">' + b.error.message + "</span>"), 
        k.unblock()) : (k.append('<input type="hidden" class="chargeio_token" name="chargeio_token" value="' + b.id + '"/>'), 
        k.submit());
    }
    function e(b) {
        var c = f(b);
        if (c.length) {
            a(".chargeio_token, .form_errors").remove();
            for (var d = 0, e = c.length; d < e; d++) {
                var g = c[d].field, h = c[d].type;
                k.append('<input type="hidden" class="form_errors" name="' + g + '" value="' + h + '">');
            }
            return k.append('<input type="hidden" class="form_errors" name="form_errors" value="1">'), 
            k.unblock(), !1;
        }
        return k.find(".woocommerce-error").remove(), !0;
    }
    function f(b) {
        var c = [];
        return b.number ? a.payment.validateCardNumber(b.number) || c.push({
            field: "cio4wc-card-number",
            type: "invalid"
        }) : c.push({
            field: "cio4wc-card-number",
            type: "undefined"
        }), b.exp_month && b.exp_year ? a.payment.validateCardExpiry(b.exp_month, b.exp_year) || c.push({
            field: "cio4wc-card-expiry",
            type: "invalid"
        }) : c.push({
            field: "cio4wc-card-expiry",
            type: "undefined"
        }), b.cvv ? a.payment.validateCardCVC(b.cvv, a.payment.cardType(b.number)) || c.push({
            field: "cio4wc-card-cvc",
            type: "invalid"
        }) : c.push({
            field: "cio4wc-card-cvc",
            type: "undefined"
        }), c;
    }
    var g, h, i, j, k = a("form.checkout, form#order_review"), l = {};
    a("body").on("updated_checkout.cio4wc", b).trigger("updated_checkout.cio4wc"), a("form.checkout").on("checkout_place_order", c), 
    a("form#order_review").on("submit", c), k.on("keyup change", '#cio4wc-card-number, #cio4wc-card-expiry, #cio4wc-card-cvc, input[name="cio4wc_card"], input[name="payment_method"]', function() {
        l.number = {
            val: h.val(),
            classes: h.attr("class")
        }, l.expiry = {
            val: i.val()
        }, l.cvv = {
            val: j.val()
        }, a(".woocommerce_error, .woocommerce-error, .woocommerce-message, .woocommerce_message, .chargeio_token, .form_errors").remove();
    });
});
//# sourceMappingURL=cio4wc.min.js.map